# Easy Video Share - Vue 3 Application

A secure video sharing application built with Vue 3, AWS Cognito authentication, and modern AWS security practices.

## 🔒 Security Features

- **AWS Cognito Authentication** - No hardcoded credentials
- **IAM Role-based Backend** - Secure Lambda execution
- **Presigned URL Uploads** - Direct-to-S3 without exposing keys
- **No AWS Access Keys** - Modern authentication throughout
- **CI/CD with OIDC** - GitHub Actions deployment without storing AWS keys

## 🚀 Quick Start

### Prerequisites

- Node.js 18+ and npm
- AWS CLI (for manual deployment) or GitHub repository (for CI/CD)
- Terraform (for infrastructure)

### Option A: Manual Deployment

#### 1. Infrastructure Setup

```bash
# Deploy AWS infrastructure
cd terraform
terraform init
terraform apply

# Generate frontend environment variables
cd ../scripts
./setup-frontend.sh
```

#### 2. Frontend Development

```bash
# Install dependencies
npm install

# Start development server
npm run dev
```

#### 3. Production Build

```bash
# Build for production (no deployment)
npm run build-only

# Or use the build script
./scripts/build-frontend.sh
```

#### 4. Manual Deployment Options

See the deployment options in the build script output or use the Terraform-generated deployment script.

### Option B: CI/CD Deployment (Recommended)

For automated deployment with GitHub Actions:

#### 1. Setup CI/CD Pipeline

```bash
# 1. Update terraform/terraform.tfvars with your GitHub repository
echo 'github_repository = "your-username/easy-video-share-vue"' >> terraform/terraform.tfvars

# 2. Deploy infrastructure with OIDC provider
cd terraform
terraform apply

# 3. Get the GitHub Actions role ARN
terraform output github_actions_role_arn

# 4. Add the role ARN as GitHub repository secret: AWS_ROLE_TO_ASSUME
```

#### 2. Automated Deployment

```bash
# Push changes to trigger deployment
git add .
git commit -m "Deploy via CI/CD"
git push origin main
```

**📖 Detailed CI/CD Setup**: See [CICD-SETUP.md](./CICD-SETUP.md) for complete instructions.

## 📁 Project Structure

```
src/
├── components/     # Reusable Vue components
├── views/          # Page components
├── composables/    # Vue composition functions
├── stores/         # Pinia state management
├── router/         # Vue Router configuration
└── core/           # Core utilities and services

terraform/          # AWS infrastructure as code
scripts/            # Deployment and setup scripts
```

## 🛠️ Available Scripts

### Development

```bash
npm run dev          # Start development server
npm run type-check   # TypeScript type checking
npm run lint         # Code linting and fixing
npm run format       # Code formatting
```

### Testing

```bash
npm run test:unit    # Unit tests with Vitest
npm run test:e2e     # E2E tests with Playwright
```

### Production

### Production

```bash
npm run build        # Full build with type checking
npm run build-only   # Fast build without type checking
npm run preview      # Preview production build locally
```

## 🔧 Configuration

### Environment Variables

The application uses these environment variables (auto-generated by `setup-frontend.sh`):

```env
# AWS Configuration
VITE_AWS_REGION=us-east-1
VITE_AWS_BUCKET_NAME=your-bucket-name
VITE_AWS_AUDIO_BUCKET_NAME=your-audio-bucket

# API Endpoints
VITE_API_ENDPOINT=https://your-api-gateway-url
VITE_API_VIDEOS_UPLOAD_URL_ENDPOINT=https://your-api/videos/upload-url

# Cognito Authentication
VITE_COGNITO_USER_POOL_ID=your-user-pool-id
VITE_COGNITO_CLIENT_ID=your-client-id

# Feature Flags
VITE_ENABLE_AI_VIDEO=true
VITE_ENABLE_AUDIO_UPLOAD=true
VITE_ENABLE_ADMIN_PANEL=true
```

### Terraform Variables

Configure `terraform/terraform.tfvars`:

```hcl
bucket_name = "easy-video-share-yourname-dev"
aws_region = "us-east-1"
environment = "dev"
```

## 🏗️ Architecture

### Frontend (Vue 3)

- **Vue 3** with Composition API
- **TypeScript** for type safety
- **Vite** for fast development and building
- **Pinia** for state management
- **Vue Router** for navigation
- **AWS Amplify** for Cognito integration

### Backend (AWS)

- **AWS Lambda** for API endpoints
- **API Gateway** for HTTP API
- **S3** for file storage
- **DynamoDB** for metadata
- **Cognito** for user authentication

### Security

- **IAM Roles** for Lambda execution
- **Presigned URLs** for secure file uploads
- **Cognito JWT** for authentication
- **CORS** properly configured

## 🔍 Troubleshooting

### Build Issues

```bash
# Check TypeScript errors
npm run type-check

# Fix linting issues
npm run lint

# Clear cache and rebuild
rm -rf node_modules dist .vite
npm install
npm run build-only
```

### Deployment Issues

- Ensure AWS CLI is configured with appropriate permissions
- Use AWS CloudShell if local AWS CLI has credential issues
- Check S3 bucket permissions and CORS configuration
- Verify API Gateway endpoints are accessible

### Authentication Issues

- Check Cognito User Pool and Client configuration
- Verify CORS settings allow your domain
- Ensure environment variables are correctly set

## 📚 Documentation

- [Vue 3 Documentation](https://vuejs.org/)
- [Vite Configuration](https://vite.dev/config/)
- [AWS Amplify Auth](https://docs.amplify.aws/lib/auth/getting-started/)
- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)

## 📄 License

This project is licensed under the MIT License.
